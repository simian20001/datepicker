<html>
<head>
    <script>
        customElements.define('parent-element',
        class extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({mode: 'open'});
                this.shadowRoot.innerHTML = `
                <h2>Parent Element</h2>
                <slot></slot>
                `;
                console.log("I'm a parent and have slots.");
                
                // Select the slot element from the ShadowDOM..
                const slot = this.shadowRoot.querySelector('slot');
                
                // ..and listen for the slotchange event.
                slot.addEventListener('slotchange', (event) => {
                    // Get the elements assigned to the slot..
                    const children = event.target.assignedElements();
                    
                    // ..loop over them and call their methods.
                    children.forEach(child => {
                        if (child.tagName.toLowerCase() === 'child-element') {
                            child.shout()
                            console.log(`Test before : ${child.test}`)
                            child.test = 0;
                            console.log(`Test after : ${child.test}`)
                        }
                    });
                });
            }
            
            connectedCallback() {
                console.log("I'm a parent and am now connected");
            }
        });
        
        customElements.define('child-element', 
        class extends HTMLElement {
            constructor() {
                super();
                this.attachShadow({mode: 'open'});
                this.shadowRoot.innerHTML = `
                <h3>Child Element</h3>
                `;
                this._props = { test: 9 };
            }
            
            get test(){
                console.log('running getter');
                return this._props.test;
            }
            
            set test(newVal){
                console.log('running setter');
                this._props.test = newVal
            }
            
            connectedCallback() {
                console.log("I'm a child and am now connected.");
            }
            
            shout() {
                console.log("I'm a child and placed inside a slot.");
            }
            
        });
    </script>
</head>
<body>
    <parent-element>
        <child-element></child-element>
        <child-element></child-element>
    </parent-element>
    <child-element></child-element>
</body>
</html>
